#include <iostream>
#include <string>
using namespace std;

struct Student {
    string name;
    int id;
    Student* next;
    Student* prev;

    Student(string n, int i) {
        name = n;
        id = i;
        next = nullptr;
        prev = nullptr;
    }
};

class TShirtQueue {
private:
    Student* front;
    Student* rear;
    int count;
    const int MAX_STUDENTS = 100; // limit of 100 students

public:
    TShirtQueue() {
        front = nullptr;
        rear = nullptr;
        count = 0;
    }

    void addStudent(string name, int id) {
        if (count >= MAX_STUDENTS) {
            cout << "Queue is full! Only the first 100 students can register for the T-shirt.\n";
            return;
        }

        Student* newStudent = new Student(name, id);

        if (!rear) {
            front = rear = newStudent;
        } else {
            rear->next = newStudent;
            newStudent->prev = rear;
            rear = newStudent;
        }

        count++;
        cout << name << " (ID: " << id << ") added to the queue."<<endl;
    }

    void serveStudent() {
        if (!front) {
            cout << "Queue is empty. No student to serve."<<endl;
            return;
        }

        cout << front->name << " (ID: " << front->id << ") has been served and removed from the queue."<<endl;

        Student* temp = front;
        front = front->next;

        if (front)
            front->prev = nullptr;
        else
            rear = nullptr;

        delete temp;
        count--;
    }

    void removeStudent(int id) {
        if (!front) {
            cout << "Queue is empty. Cannot remove student."<<endl;
            return;
        }

        Student* current = front;
        while (current) {
            if (current->id == id) {
                if (current->prev)
                    current->prev->next = current->next;
                else
                    front = current->next;

                if (current->next)
                    current->next->prev = current->prev;
                else
                    rear = current->prev;

                cout << current->name << " (ID: " << current->id << ") has left the queue."<<endl;
                delete current;
                count--;
                return;
            }
            current = current->next;
        }

        cout << "Student with ID " << id << " not found in the queue."<<endl;
    }

    void displayQueue() {
        if (!front) {
            cout << "Queue is empty."<<endl;
            return;
        }

        Student* current = front;
        cout << "\nCurrent Queue:\n";
        while (current) {
            cout << "Name: " << current->name << " | ID: " << current->id << endl;
            current = current->next;
        }
        cout << endl;
    }

    void countStudents() {
        cout << "Total students in queue: " << count << " / " << MAX_STUDENTS << endl;
    }

    ~TShirtQueue() {
        Student* current = front;
        while (current) {
            Student* next = current->next;
            delete current;
            current = next;
        }
    }
};

int main() {
    TShirtQueue queue;
    int choice;

    do {
        cout << "\n==== Code-a-Thon T-Shirt Queue ====\n";
        cout << "1. Add Student"<<endl;
        cout << "2. Serve Student"<<endl;
        cout << "3. Student Leaves Queue"<<endl;
        cout << "4. Display Queue"<<endl;
        cout << "5. Count Students"<<endl;
        cout << "6. Exit"<<endl;
        cout << "Enter your choice: ";
        cin >> choice;
        cin.ignore();

        switch (choice) {
            case 1: {
                string name;
                int id;
                cout << "Enter student name: ";
                getline(cin, name);
                cout << "Enter student ID: ";
                cin >> id;
                queue.addStudent(name, id);
                break;
            }
            case 2:
                queue.serveStudent();
                break;

            case 3: {
                int id;
                cout << "Enter student ID to remove: ";
                cin >> id;
                queue.removeStudent(id);
                break;
            }

            case 4:
                queue.displayQueue();
                break;

            case 5:
                queue.countStudents();
                break;

            case 6:
                cout << "Exiting the application."<<endl;
                break;

            default:
                cout << "Invalid choice. Please try again."<<endl;
        }

    } while (choice != 6);

    return 0;
}

